# JIT 컴파일러
- JIT 컴파일러를 이해하기 전에 자바의 컴파일 과정을 이해해야 한다.
![javaCompileProcess.png](..%2Fimg%2Fjava%2FjavaCompileProcess.png)
  - 자바 코드 파일을 javac(컴파일러)가 컴파일하며 **클래스 파일**로 생성한다. 이때 클래스 파일은 **바이트 코드로 이루어져 있지만 운영체제가 해석하는 기계어**는 아니다.
  - 컴파일된 바이트 코드를 jvm의 인터프리터가 기계어로 변환하여 **운영체제에서 독립적인 실행이 가능**하게 된다.
- 문제는 jvm 인터프리터의 **성능 저하**다. 인터프리터는 코드 실행 시 한 줄씩 기계어로 변환하기 때문에 별도의 컴파일 과정이 없다는 장점이 있지만 그만큼 **수행 속도가 느리다.**
- 그렇기 때문에 JIT 컴파일러로 자주 실행되는 **메소드나 코드 블럭을 컴파일하고 캐싱**하여 성능을 보완하였다.

## 전부 JIT 컴파일러로 컴파일하면 안 될까?
- 성능을 위해서 모든 메소드나 코드 블럭을 JIT 컴파일러로 컴파일하면 안 될까?
- 이는 컴파일러의 특성과 관련되어 있다. 컴파일러는 초기에 코드를 한 번에 컴파일 하기 때문에 **스캔 속도가 느리다**. 또한 컴파일한 코드로 이루어진 파일이 필요하기 때문에 **메모리 효율이 좋지 않다**.
- 위와 같은 이유로 JIT 컴파일러는 인터프리터 임계치에 도달한 즉, 자주 사용하는 메소드나 코드 블럭을 **컴파일하고 캐싱**한다.
- JIT 컴파일러 임계값 지정 방법
  - `java -XX:CompileThreshold=5000 Test`
  - Test.class를 5000번 이상 호출 시 JIT 컴파일러로 컴파일하겠다는 의미이다.

## 캐싱한 건 어디에 저장할까?
- JVM의 code cache에 저장한다.
- Code Cache의 크기는 **-XX:ReservedCodeCacheSize** 옵션을 통해 지정할 수 있다.


https://www.baeldung.com/jvm-code-cache
